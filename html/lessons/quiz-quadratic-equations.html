<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz ¬∑ Quadratic Equations</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../css/learner.css">
</head>

<body>
  <div class="app quiz-app">
    <aside class="sidebar">
      <div class="logo"><img src="/images/logo transparent.png" alt="KiraKira logo"></div>
      <nav class="nav">
        <a href="../learner-home.html">Dashboard</a>
        <a href="../learner-progress.html">Progress</a>
        <a href="../learner-pastyears.html">Past Papers</a>
        <a href="../learner-classes.html">Classes</a>
        <a href="../learner-community.html">Community</a>
        <a href="../learner-profile.html">Profile</a>
      </nav>
    </aside>

    <main class="main lesson-page">
      <header class="page-heading">
        <p class="eyebrow">Module 01 ¬∑ Quadratic Equations</p>
        <h1>Quick Quiz</h1>
        <p>Let‚Äôs test your solving skills and intuition about quadratic equations.</p>
      </header>

      <section class="card lesson-block">
        <div id="quiz" class="quiz-block"></div>
      </section>
    </main>
  </div>

<script src="../../js/learner-session.js"></script>
<script src="../../js/learner-activity.js"></script>
<script>
  const quizData = [
    {
      question: "Which of the following is the standard form of a quadratic equation?",
      options: [
        "y = mx + c",
        "ax¬≤ + bx + c = 0",
        "a(x - h)¬≤ + k"
      ],
      correct: 1,
      explanation: "The standard form of a quadratic equation is ax¬≤ + bx + c = 0."
    },
    {
      question: "If the discriminant (b¬≤ - 4ac) is less than 0, how many real roots exist?",
      options: ["2 real roots", "1 real root", "No real roots"],
      correct: 2,
      explanation: "When b¬≤ - 4ac < 0, the quadratic has no real roots ‚Äî only complex ones."
    },
    {
      question: "What method can always solve any quadratic equation, even if it can‚Äôt be factored?",
      options: [
        "Factoring",
        "Quadratic Formula",
        "Completing the square"
      ],
      correct: 1,
      explanation: "The quadratic formula works for all quadratics, even when factoring fails."
    },
    {
      question: "For y = x¬≤ - 6x + 8, what are the roots?",
      options: ["x = 4 and x = 2", "x = -4 and x = -2", "x = 3 and x = -3"],
      correct: 0,
      explanation: "Factoring (x - 2)(x - 4) = 0 gives roots x = 2 and x = 4."
    },
    {
      question: "If the graph of a quadratic only touches the x-axis once, what does that mean?",
      options: ["Two distinct roots", "No real roots", "One repeated root"],
      correct: 2,
      explanation: "Touching once means a repeated (equal) root ‚Äî the vertex lies on the x-axis."
    }
  ];

  let current = 0;
  let score = 0;
  const quizStartedAt = Date.now();
  const quizContainer = document.getElementById("quiz");

  function renderQuestion() {
    const q = quizData[current];
    quizContainer.innerHTML = `
      <div class="quiz-progress">Question ${current + 1} of ${quizData.length}</div>
      <h2>${q.question}</h2>
      <div class="quiz-options">
        ${q.options.map(
          (opt, i) => `<button class="quiz-option" data-index="${i}">${opt}</button>`
        ).join("")}
      </div>
      <p class="quiz-feedback"></p>
    `;
    document.querySelectorAll(".quiz-option").forEach(btn =>
      btn.addEventListener("click", handleAnswer)
    );
  }

  function handleAnswer(e) {
    const index = parseInt(e.target.dataset.index);
    const q = quizData[current];
    const feedback = document.querySelector(".quiz-feedback");
    const buttons = document.querySelectorAll(".quiz-option");

    buttons.forEach(b => b.disabled = true);
    e.target.classList.add(index === q.correct ? "correct" : "wrong");

    if (index === q.correct) score++;

    feedback.textContent = index === q.correct
      ? "‚úÖ " + q.explanation
      : "‚ùå " + q.explanation;

    const nextBtn = document.createElement("button");
    nextBtn.className = "btn btn--primary quiz-next";
    nextBtn.textContent = current < quizData.length - 1 ? "Next" : "Finish";
    nextBtn.addEventListener("click", nextQuestion);
    feedback.after(nextBtn);
  }

  function nextQuestion() {
    current++;
    if (current < quizData.length) {
      renderQuestion();
    } else {
      renderResults();
    }
  }

  function renderResults() {
    const total = quizData.length;
    const percent = Math.round((score / total) * 100);
    let message, sub;

    if (percent === 100) {
      message = "üèÜ Perfect!";
      sub = "Flawless solving ‚Äî you‚Äôve mastered quadratic equations.";
    } else if (percent >= 60) {
      message = "‚ú® Great job!";
      sub = "You‚Äôre solid! A few more practices and you‚Äôll ace every discriminant and root.";
    } else {
      message = "üå± Keep going!";
      sub = "Not bad ‚Äî revisit factoring and the quadratic formula, then try again.";
    }

    quizContainer.innerHTML = `
      <h2>${message}</h2>
      <p>You got <strong>${score}</strong> out of <strong>${total}</strong> correct (${percent}%).</p>
      <p>${sub}</p>
      <div class="wrap-actions">
        <a href="quiz-quadratic-equations.html" class="btn btn--ghost">Try again</a>
        <a href="../course-map.html?module=form4-01" class="btn btn--primary">Back to module map</a>
      </div>
    `;

    if (window.kiraActivity && typeof window.kiraActivity.logModuleQuiz === "function") {
      window.kiraActivity.logModuleQuiz({
        moduleId: "form4-01",
        unitId: "quiz-solving-paths",
        scorePercent: percent,
        durationSeconds: Math.max(1, Math.round((Date.now() - quizStartedAt) / 1000))
      });
    }
    if (window.kiraActivity && typeof window.kiraActivity.logModuleProgress === "function") {
      window.kiraActivity.logModuleProgress({
        moduleId: "form4-01",
        unitId: "quiz-solving-paths",
        status: "completed",
        scorePercent: percent,
        durationSeconds: Math.max(1, Math.round((Date.now() - quizStartedAt) / 1000))
      });
    }
  }

  renderQuestion();
</script>

</body>
</html>
