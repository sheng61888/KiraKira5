<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - KiraKira</title>
    <link rel="stylesheet" href="../css/learner.css">
    <link rel="stylesheet" href="../css/admin.css">
</head>
<body>
    <div class="app">
        <aside class="sidebar">
            <div class="logo">
                <img src="../images/logo transparent.png" alt="KiraKira Logo">
            </div>
            <nav class="nav">
                <a href="admin-dashboard.html">Dashboard</a>
                <a href="admin-UserManagement.html">User Management</a>
                <a href="admin-CourseManagement.html">Module Management</a>
                <a href="admin-CommunityManagement.html">Community Management</a>
                <a href="admin-Reporting.html" aria-current="page">Reports</a>
                <a href="admin-Profile.html">Profile</a>
                <a href="../html/login_signup.html">Sign Out</a>
            </nav>
        </aside>

        <main class="main">
            <header class="page-heading">
                <div>
                    <p class="eyebrow">Admin Panel</p>
                    <h1>Reporting and Analytics</h1>
                </div>
                <button onclick="exportToPDF()" class="btn btn-primary">Export Report as PDF</button>
            </header>

            <section class="card">
                <div class="section-head">
                    <div>
                        <p class="eyebrow">User Analytics</p>
                        <h2>User Distribution by Role</h2>
                    </div>
                </div>
                <div class="grid stats-grid">
                    <article class="stat-block">
                        <h3>Learners</h3>
                        <strong id="learnerCount">-</strong>
                    </article>
                    <article class="stat-block">
                        <h3>Teachers</h3>
                        <strong id="teacherCount">-</strong>
                    </article>
                    <article class="stat-block">
                        <h3>Admins</h3>
                        <strong id="adminCount">-</strong>
                    </article>
                </div>
            </section>

            <section class="card">
                <div class="section-head">
                    <div>
                        <p class="eyebrow">Website Analytics</p>
                        <h2>Website Visits</h2>
                    </div>
                    <div>
                        <label for="visitYearFilter">Year:</label>
                        <select id="visitYearFilter" onchange="applyVisitFilter()">
                            <option value="">All</option>
                        </select>
                        <label for="visitMonthFilter" style="margin-left: 1rem;">Month:</label>
                        <select id="visitMonthFilter" onchange="applyVisitFilter()">
                            <option value="">All</option>
                        </select>
                    </div>
                </div>
                <canvas id="visitsChart" style="max-height: 300px;"></canvas>
            </section>

            <section class="card">
                <div class="section-head">
                    <div>
                        <p class="eyebrow">Community Activity</p>
                        <h2>Community Engagement Statistics</h2>
                    </div>
                </div>
                <div class="grid stats-grid">
                    <article class="stat-block">
                        <h3>Total Threads</h3>
                        <strong id="totalThreads">-</strong>
                    </article>
                    <article class="stat-block">
                        <h3>Total Replies</h3>
                        <strong id="totalReplies">-</strong>
                    </article>
                </div>
                <div class="section-head" style="margin-top: 2rem;">
                    <h3>Most Active Users</h3>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Activity Count</th>
                            </tr>
                        </thead>
                        <tbody id="activeUsersTable">
                            <tr><td colspan="2" class="text-muted">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="card">
                <div class="section-head">
                    <div>
                        <p class="eyebrow">Registration Analytics</p>
                        <h2>Registered Users</h2>
                    </div>
                    <div>
                        <label for="roleFilter">Filter by Role:</label>
                        <select id="roleFilter" onchange="applyFilter()">
                            <option value="">All Roles</option>
                            <option value="learner">Learner</option>
                            <option value="teacher">Teacher</option>
                            <option value="admin">Admin</option>
                        </select>
                        <label for="yearFilter" style="margin-left: 1rem;">Year:</label>
                        <select id="yearFilter" onchange="applyFilter()">
                            <option value="">All</option>
                        </select>
                        <label for="monthFilter" style="margin-left: 1rem;">Month:</label>
                        <select id="monthFilter" onchange="applyFilter()">
                            <option value="">All</option>
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Registration Date</th>
                            </tr>
                        </thead>
                        <tbody id="registeredUsersTable">
                            <tr><td colspan="4" class="text-muted">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

        </main>
 
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="../js/admin-reporting.js"></script>
</body>
</html>
